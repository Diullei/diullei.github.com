<!DOCTYPE html>
<html class="wf-adelle-n4-active wf-adelle-i4-active wf-adelle-n7-active wf-adelle-i7-active wf-active"><head>
	<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diullei Gomes</title>
    
    <link rel="stylesheet" type="text/css" href="../assets/screen.css">
    	
  </head>
  <body><div id="container">
  <div id="nav">
    
      <div id="header">
        <a href="#" id="logo">
			{=Diullei Gomes}
		</a>
		  <div>
			<span style="font-style:italic;color:#808080">Cristão, Programador .NET apaixonado por Desenvolvimento de Software.</span>
		  </div>
		
		  <div class="extra twitter">
			<a href="https://twitter.com/diullei" class="twitter-follow-button" data-show-count="false" data-lang="en">Follow @diullei</a>
			<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
		  </div>
      </div>
    
    <ul id="sections">
            
        <li>
          <a href="#">Artigos</a>
          
            <ul id="artigos"><li><a href='Debugando-TyprScript-no-navegador.html'><span>[16-10-2012]</span> Debugando TyprScript no navegador<br/></a></li><li><a href='Introducao-ao-TypeScript.html'><span>[12-10-2012]</span> Introdução ao TypeScript<br/></a></li><li><a href='JavaScript-NoConflict.html'><span>[29-07-2012]</span> JavaScript - NoConflict<br/></a></li><li><a href='Lendo-arquivos-com-Nodejs.html'><span>[18-07-2012]</span> Lendo arquivos com Node.js<br/></a></li><li><a href='Configurando-o-NodeJs-com-o-Npp.html'><span>[17-07-2012]</span> Configurando o NodeJs com o NotePad++<br/></a></li></ul>
          
        </li>
            
    </ul>
          
  </div>
	<a href="https://github.com/Diullei/diullei.github.com" id="github-ribbon"><img src="../assets/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a>
	  <div id="content">
			<div id="blog-content">
				<h1>Debugando TyprScript no navegador</h1><span>by: Diullei Gomes @ 16-10-2012</span><hr/><h2 id="introduo">Introdução</h2>

<p>Existe um recurso bem interessante implementado no Firefox e no Chrome (não sei ao certo quais outros navegadores) chamado <a href="http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/">Source Maps</a>. Para entender do que se trata tenha em mente um arquivo javascript minificado. Para rastrear um bug no código deste arquivo por exemplo teríamos que usar a versão não minificada do mesmo. Uma vez encontrado o bug este seria corrigido e um novo arquivo minificado seria gerado. Um Source Map é um arquivo de mapeamento que faz um dê-para (no nosso caso) do arquivo minificado com o arquivo real. A partir deste mapeamento o browser consegue realizar o debug no arquivo original(não minificado) em bora a execução real esteja ocorrendo no arquivo minificado.</p>

<p>Até aqui isso não agregou muito por que basta referenciar o arquivo original como dito anteriormente. Uma vez que tenhamos o problema rastreado ou a feature implementada minificamos tudo novamente.</p>

<h3 id="comoissopodenosajudarnodebugdecdigotypescript">Como isso pode nos ajudar no Debug de código TypeScript?</h3>

<p>TypeScrit assim como CoffeeScrit e Dart entre outros são pré-processadores que geram no final das contas código JavaScript. Como a maioria dos pré-processadores tenta melhorar a sintaxe do código na escrita de expressões lambda, iterações, classes, interfaces, heranças e etc, temos uma dissonância entre o código escrito em TypeScript por exemplo com o código JavaScript gerado no final.</p>

<p>Aqui entra em ação o Source Map. Com ele assim como podemos mapear um arquivo minificado com seu arquivo original, podemos também mapear um arquivo TypeScript original com seu código final gerado em JavaScript. Isso abre novas possibilidades de debug. Novas ferramentas de debug e refatoração podem ser criadas a partir deste recurso.</p>

<p>É aí que entra o assunto deste artigo. Vou mostrar como debugar TypeScript em um navegador com suporte a Source Maps. No meu caso vamos usar o Chrome.</p>

<h2 id="habilitandosourcemapnogooglechrome">Habilitando Source Map no Google Chrome</h2>

<p>Para habilitar o recurso de source maps no Chrome basta acessar Settings e selecionar a caixa "Enable source maps". Veja na imagem abaixo:</p>

<p><img src="/posts/img/debug_typescript/enable_source_map.png" alt="Valid XHTML" title="" /></p>

<p>Feito isso estamos pronto para debugar nosso código.</p>

<h2 id="criandoonossocdigodetestes">Criando o nosso código de testes</h2>

<p>Para exemplo vamos criar um arquivo com um código TypeScript muito simples. Salve o código abaixo em um arquivo chamado <code>script.ts</code>.</p>

<pre style="javascript"><code>interface IPessoa{
    nome: string;
    sobreNome: string;
    nomeCompleto: () => string;
}

class Pessoa implements IPessoa {
    nome: string;

    sobreNome: string;

    nomeCompleto(): string {
        return "Nome: " + this.nome + " " + this.sobreNome;
    }
}

var pessoa = new Pessoa();
pessoa.nome = "Diullei";
pessoa.sobreNome = "Gomes";

var element = document.getElementById('content');

element.innerHTML = pessoa.nomeCompleto();</code></pre>

<p>Agora crie um arquivo chamado <code>index.html</code> e coloque o código abaixo:</p>

<pre class="html"><code>&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta&gt;
    &lt;title&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div id="content"&gt;&lt;/div&gt;
    &lt;script type="text/javascript" src="script.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>

<p>Estes arquivos precisam estar no mesmo folder.</p>

<h2 id="sourcemapsparatypescript">Source Maps para TypeScript</h2>

<p>Tendo nosso pequeno projeto em mãos agora precisamos gerar nosso arquivo source map. Felizmente o time que trabalha no TypeScript fez um trabalho muito bom incluindo um gerador de source maps no <a href="http://typescript.codeplex.com/SourceControl/changeset/view/d397c54a55db#src%2fcompiler%2fsourceMapping.ts">compilador do TypeScript</a>. Embora não seja documentado no help do utilitário de compilação do TypeScript para gerar o arquivo sourcemap basta executar a compilação da seguinte forma: <code>tsc --sourcemap script.ts</code>. Feito isso repare que um arquivo chamado <code>script.js.map</code> é gerado. Repare também que este arquivo é referenciado no final do arquivo script.js gerado pelo compilador como na linha abaixo:</p>

<p><code>//@ sourceMappingURL=script.js.map</code></p>

<p>Tendo compilado o arquivo script.ts agora basta abrir a página <code>index.html</code> no Chrome. Coloque um breakpoint no código para ver o debug do TypeScript em ação. Veja na imagem abaixo:</p>

<p><img src="/posts/img/debug_typescript/debug.png" alt="Valid XHTML" title="" /></p>

<h2 id="concluso">Conclusão</h2>

<p>Como vimos o recurso Source Maps abre muitas possibilidades no tocante a rastreamento de código.</p>

<ul>
<li>Para saber mais sobre Source Maps acesse <a href="http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/">http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/</a></li>
<li>Para saber mais sobre TypeScript acesse <a href="http://diullei.github.com/TypeScript-ptBR/">http://diullei.github.com/TypeScript-ptBR/</a></li>
</ul>

<p>Um grande abraço e até a próxima!</p>
			</div>
  
		   <div id="disqus_thread"></div>
		   <script>
				/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
				var disqus_shortname = 'diulleigomes'; // required: replace example with your forum shortname
				var disqus_identifier = 'Debugando TyprScript no navegador';
				var disqus_title = 'Debugando TyprScript no navegador';
				var disqus_message = 'Debugando TyprScript no navegador';
				/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
				(function() {
					var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
					dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
					(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
				})();
		   </script>
			<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
			<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
         
	  </div>
  
</div>

    <script src="assets/jquery.js"></script>
    <script src="assets/showdown.js"></script>
	<script src="assets/highlight.min.js"></script>
	<script src="assets/blog.js"></script>

</body></html>