<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>TypeScript - Union Types | Diullei</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/very-simple.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><!-- include the sidebar--><!-- include ./includes/sidebar.jade--><!-- Blog title and subtitle--><header><div class="container header"><a id="logo" href="/." class="title">Diullei</a><span class="subtitle"></span><label id="toggle-menu" for="menu" onclick=""><i class="fa fa-bars"></i></label></div></header><!-- use checkbox hack for toggle nav-bar on small screens--><input id="menu" type="checkbox"><!-- Navigation Links--><nav id="nav"><div class="container"><a href="/" class="sidebar-nav-item active">Home</a><a href="/about" class="sidebar-nav-item">About</a><a href="/archives" class="sidebar-nav-item">Archives</a></div></nav><div id="header-margin-bar"></div><!-- gallery that comes before the header--><div class="wrapper"><div class="container post-header"><h1>TypeScript - Union Types</h1></div></div><div class="wrapper"><div class="container meta"><div class="post-time">13-07-2016</div><div class="post-categories"><a class="post-category-link" href="/categories/TypeScript/">TypeScript</a>><a class="post-category-link" href="/categories/TypeScript/TypeScript-v1-4/">TypeScript v1.4</a></div><div class="post-tags"><a class="post-tag-link" href="/tags/JavaScript/">JavaScript</a>/<a class="post-tag-link" href="/tags/TypeScript/">TypeScript</a></div></div></div><article><div class="container post"><p>Uma das caracteristicas do JavaScript é que podemos facilmente alterar o tipo de uma variável em tempo de execução simplesmente atribuindo um valor de tipo diferente a esta variável. No momento em que o valor é atribuido o tipo desta variável se altera e a partir daí inúmeros bugs podem surgir se não estivermos atentos.</p>
<p>Em Typecript quando declaramos uma variável com um tipo específico, <code>string</code> por exemplo, ela carregará este tipo até o fim, ou seja, em nenhum momento será permitida a atribuição de um valor de tipo diferente nesta variável.</p>
<pre><code>let val: string;
// Erro! val só pode receber um valor do tipo string
val = false;
</code></pre><a id="more"></a>
<p>O que ocorre é que em JavaScript ocasionalmente teremos variáveis ou parâmetros que irão esperar receber em momentos diferentes, valores de tipos diferentes. Quando configuramos uma requisição ajax no <code>jQuery</code> por exemplo (<a href="http://api.jquery.com/jquery.ajax/" target="_blank" rel="noopener">jQuery ajax doc</a>), a propriedade <code>jsonp</code> pode assumir o valor <code>false</code> ou um valor do tipo <code>string</code>. Prevendo esse comportamente o TypeScript definiu um tipo chamado <code>any</code>. Esse tipo aceita qualquer valor de qualquer tipo. O problema aqui é que nem sempre declarar uma variável como <code>any</code> resolverá nosso problema. Pra que isso fique bem claro vamos a um exemplo:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Takes a string and adds "padding" to the left.</span></span><br><span class="line"><span class="comment"> * If 'padding' is a string, then 'padding' is appended to the left side.</span></span><br><span class="line"><span class="comment"> * If 'padding' is a number, then that number of spaces is added to the left side.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">padLeft</span>(<span class="params">value: <span class="built_in">string</span>, padding: <span class="built_in">any</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> padding === <span class="string">"number"</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Array</span>(padding + <span class="number">1</span>).join(<span class="string">" "</span>) + value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> padding === <span class="string">"string"</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> padding + value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">`Expected string or number, got '<span class="subst">$&#123;padding&#125;</span>'.`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">padLeft(<span class="string">"Hello world"</span>, <span class="number">4</span>); <span class="comment">// retorna "    Hello world"</span></span><br></pre></td></tr></table></figure>
<p>Note que no código acima o parâmetro <code>padding</code> está sendo declarado como <code>any</code>. O que não impede que que passemos um valor diferente de <code>string</code> ou <code>number</code> como por exemplo o valor <code>true</code>. O código acima compila normalmente sem nenhum erro mas falha no momento da execução.</p>
<pre><code>// compila sem erros mas falha no momento da execução
let indentedString = padLeft(&quot;Hello world&quot;, true);
</code></pre><p>Para contornar esse problema o TypeScript possui uma classe especial de declaração de tipos chamado de “union types” que permite definir no momento da escrita do código quais os valores que serão aceitos pelo parâmetro ou pela variável. Para isso utilizamos o operador <code>|</code>. Veja que no código acima que queremos que <code>padding</code> seja um parâmetros de tipo menos permissivo e aceite apenas valores do tipo <code>string</code> ou <code>number</code> e para isso alteramos a assinatura do tipo de <code>any</code> para <code>string | number</code>. Vamos alterar a assinatura da função <code>padLeft</code> para demonstrar esse recurso:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">padLeft</span>(<span class="params">value: <span class="built_in">string</span>, padding: <span class="built_in">string</span> | <span class="built_in">number</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// erro durante a compilação</span></span><br><span class="line"><span class="keyword">let</span> indentedString = padLeft(<span class="string">"Hello world"</span>, <span class="literal">true</span>);</span><br></pre></td></tr></table></figure>
<p>Agora temos uma falha no momento da compilação do código. O que aconteceu? O compilador do TypeScript entendeu que <code>padding</code> pode assumir apenas um valor <code>string</code> ou <code>number</code>.</p>
<p>Veja como esse recurso nos ajuda a proteger o código de possíveis erros que passariam despercebidos.</p>
<p>É isso. Até a próxima!</p>
<blockquote>
<p>Reference: TS v1.4 <a href="https://github.com/Microsoft/TypeScript/pull/824" target="_blank" rel="noopener">https://github.com/Microsoft/TypeScript/pull/824</a></p>
</blockquote>
</div><!-- comment system--><div class="container"><hr><div id="disqus_thread"></div><script type="text/javascript">
var disqus_shortname = 'diullei-blog';
var disqus_identifier = '2016/07/13/union-types/';
var disqus_title = 'TypeScript - Union Types';
var disqus_url = 'http://diullei.com/2016/07/13/union-types/';
(function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">Blog comments powered by <span class="logo-disqus">Disqus</span></a></div></article><footer id="footer"><div class="container"><div class="bar"><div class="social"><a href="/atom.xml" target="_blank"><i class="fa fa-rss"></i></a></div><div class="footer">© 2019 <a href="/" rel="nofollow">Diullei Gomes</a>. Powered by <a rel="nofollow" target="_blank" href="https://hexo.io">Hexo</a>. Theme <a target="_blank" href="https://github.com/lotabout/very-simple">very-simple</a>.</div></div></div></footer><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
    $(".fancybox").fancybox();
});
</script></body></html>